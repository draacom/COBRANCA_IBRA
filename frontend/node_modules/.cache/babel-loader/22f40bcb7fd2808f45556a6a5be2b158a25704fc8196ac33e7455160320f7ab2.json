{"ast":null,"code":"import _objectSpread from\"D:/OneDrive/Attachments/\\xC1rea de Trabalho/projetos/COBRANCA_IBRA/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import api from'../services/api';import SuccessModal from'../components/SuccessModal';import{useAuth}from'../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Profile=()=>{const{user}=useAuth();const[formData,setFormData]=useState({name:(user===null||user===void 0?void 0:user.name)||'',email:(user===null||user===void 0?void 0:user.email)||'',password:''});const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[success,setSuccess]=useState('');const[successOpen,setSuccessOpen]=useState(false);const[successMessage,setSuccessMessage]=useState('');useEffect(()=>{const fetchProfile=async()=>{try{var _res$data$data;setLoading(true);const res=await api.get('/users/me/profile');const u=(_res$data$data=res.data.data)===null||_res$data$data===void 0?void 0:_res$data$data.user;if(u){setFormData({name:u.name,email:u.email,password:''});}}catch(err){console.error('Erro ao carregar perfil',err);}finally{setLoading(false);}};fetchProfile();},[]);const handleInputChange=e=>{const{name,value}=e.target;setFormData(_objectSpread(_objectSpread({},formData),{},{[name]:value}));};const handleSubmit=async e=>{e.preventDefault();setError('');setSuccess('');try{var _res$data$data2;const payload=_objectSpread({},formData);if(!payload.password)delete payload.password;const res=await api.put('/users/me/profile',payload);const updated=(_res$data$data2=res.data.data)===null||_res$data$data2===void 0?void 0:_res$data$data2.user;if(updated){localStorage.setItem('user',JSON.stringify(updated));}setSuccessMessage('Perfil atualizado com sucesso!');setSuccessOpen(true);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{password:''}));}catch(err){var _err$response,_err$response$data;console.error('Erro ao atualizar perfil',err);setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Erro ao salvar alterações.');}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(SuccessModal,{open:successOpen,message:successMessage,onClose:()=>setSuccessOpen(false)}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold text-gray-900\",children:\"Meu Perfil\"}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:\"Carregando...\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 bg-white shadow rounded p-4 max-w-2xl\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-2 bg-red-50 text-red-700 rounded\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Nome\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleInputChange,className:\"mt-1 w-full border rounded px-3 py-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:formData.email,onChange:handleInputChange,className:\"mt-1 w-full border rounded px-3 py-2\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Senha (deixe em branco para manter)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:formData.password,onChange:handleInputChange,className:\"mt-1 w-full border rounded px-3 py-2\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 flex justify-end space-x-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700\",children:\"Salvar\"})})]})]})]});};export default Profile;","map":{"version":3,"names":["React","useEffect","useState","api","SuccessModal","useAuth","jsx","_jsx","jsxs","_jsxs","Profile","user","formData","setFormData","name","email","password","loading","setLoading","error","setError","success","setSuccess","successOpen","setSuccessOpen","successMessage","setSuccessMessage","fetchProfile","_res$data$data","res","get","u","data","err","console","handleInputChange","e","value","target","_objectSpread","handleSubmit","preventDefault","_res$data$data2","payload","put","updated","localStorage","setItem","JSON","stringify","prev","_err$response","_err$response$data","response","message","children","open","onClose","className","onSubmit","type","onChange","required"],"sources":["D:/OneDrive/Attachments/Área de Trabalho/projetos/COBRANCA_IBRA/frontend/src/pages/Profile.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport api from '../services/api';\nimport SuccessModal from '../components/SuccessModal';\nimport { useAuth } from '../contexts/AuthContext';\n\nconst Profile = () => {\n  const { user } = useAuth();\n  const [formData, setFormData] = useState({ name: user?.name || '', email: user?.email || '', password: '' });\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const [successOpen, setSuccessOpen] = useState(false);\n  const [successMessage, setSuccessMessage] = useState('');\n\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        setLoading(true);\n        const res = await api.get('/users/me/profile');\n        const u = res.data.data?.user;\n        if (u) {\n          setFormData({ name: u.name, email: u.email, password: '' });\n        }\n      } catch (err) {\n        console.error('Erro ao carregar perfil', err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchProfile();\n  }, []);\n\n  const handleInputChange = (e) => {\n    const { name, value } = e.target;\n    setFormData({ ...formData, [name]: value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    setSuccess('');\n    try {\n      const payload = { ...formData };\n      if (!payload.password) delete payload.password;\n      const res = await api.put('/users/me/profile', payload);\n      const updated = res.data.data?.user;\n      if (updated) {\n        localStorage.setItem('user', JSON.stringify(updated));\n      }\n      setSuccessMessage('Perfil atualizado com sucesso!');\n      setSuccessOpen(true);\n      setFormData((prev) => ({ ...prev, password: '' }));\n    } catch (err) {\n      console.error('Erro ao atualizar perfil', err);\n      setError(err.response?.data?.message || 'Erro ao salvar alterações.');\n    }\n  };\n\n  return (\n    <div>\n      <SuccessModal open={successOpen} message={successMessage} onClose={() => setSuccessOpen(false)} />\n      <h1 className=\"text-2xl font-semibold text-gray-900\">Meu Perfil</h1>\n      {loading ? (\n        <div className=\"mt-4\">Carregando...</div>\n      ) : (\n        <div className=\"mt-6 bg-white shadow rounded p-4 max-w-2xl\">\n          {error && <div className=\"mb-4 p-2 bg-red-50 text-red-700 rounded\">{error}</div>}\n          {/* Removido alerta inline em favor do modal de sucesso padronizado */}\n          <form onSubmit={handleSubmit}>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">Nome</label>\n                <input type=\"text\" name=\"name\" value={formData.name} onChange={handleInputChange} className=\"mt-1 w-full border rounded px-3 py-2\" required />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700\">Email</label>\n                <input type=\"email\" name=\"email\" value={formData.email} onChange={handleInputChange} className=\"mt-1 w-full border rounded px-3 py-2\" required />\n              </div>\n              <div className=\"md:col-span-2\">\n                <label className=\"block text-sm font-medium text-gray-700\">Senha (deixe em branco para manter)</label>\n                <input type=\"password\" name=\"password\" value={formData.password} onChange={handleInputChange} className=\"mt-1 w-full border rounded px-3 py-2\" />\n              </div>\n            </div>\n            <div className=\"mt-4 flex justify-end space-x-2\">\n              <button type=\"submit\" className=\"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700\">Salvar</button>\n            </div>\n          </form>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Profile;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}